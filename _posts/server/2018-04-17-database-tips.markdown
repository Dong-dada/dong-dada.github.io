---
layout: post
title:  "数据库小知识"
date:   2018-04-17 15:34:30 +0800
categories: server
---

* TOC
{:toc}


## 时间相关的字段，考虑使用 UTC_TIMESTAMP()

有时候数据库里需要记录一些时间值，这时候要考虑这个时间应该怎么生成。

直接在代码里生成，然后写入到数据库的话，也是可以的，但本机时间有可能是错的。所以最好利用数据库的时间函数来完成此操作。

MySQL 里跟时间有关系的函数有以下几个：

- NOW() : 获取当前时区时间，形如 `2008-08-08 22:20:46`
- CURDATE() : 获取当前时区日期, 形如 `2008-08-08`
- CURTIME() : 获取当前时区时间, 形如 `22:41:30`
- UTC_TIMESTAMP() : 获取当前 UTC 时间，形如 `2008-08-08 14:47:11`
- UTC_DATE() : 获取当前 UTC 日期，形如 `2008-08-08`
- UTC_TIME() : 获取当前 UTC 时间，形如 `14:47:11`

UTC(Coordinated Universal Time, 协调世界时)，是一个世界时间标准，同一时刻北京和布宜诺斯艾利斯的 UTC 时间是一模一样的。

类似的概念还有 GMT(Greenwich Mean Time, 格林威治时间)，也是一个时间标准，你可以认为 UTC 和 GMT 是等价的，同一时刻北京和布宜诺斯艾利斯的 GMT 时间也是一样的。

MySQL 的 NOW(), CURDATE(), CURTIME() 函数返回的是时区时间。

如果你的服务涉及到了国际化，需要给别国访问，那么最好在数据库里保存 UTC/GMT 时间，在展示的时候再把它转换成当前时区的时间。